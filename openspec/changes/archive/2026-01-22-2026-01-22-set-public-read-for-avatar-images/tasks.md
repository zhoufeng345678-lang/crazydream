# Tasks: 设置头像图片为OSS公共读权限

## 实现任务

### 1. 修改OssService.uploadAvatar方法
**优先级**: P0  
**预计时间**: 20分钟

在OssService.java的uploadAvatar方法中，在成功上传文件到OSS后：
- 获取已上传文件的扩展名
- 检查扩展名是否在ALLOWED_EXTENSIONS列表中（判断是否为图片）
- 如果是图片格式，调用`ossClient.setObjectAcl(bucketName, objectKey, CannedAccessControlList.PublicRead)`设置公共读权限
- 添加适当的日志记录（成功设置权限或跳过非图片文件）
- 确保异常处理不影响主流程（ACL设置失败时记录错误但不阻止返回URL）

**依赖**: 无  
**可并行**: 是

**验证标准**:
- 上传JPG/PNG/GIF格式的图片后，可通过返回的URL直接访问
- 非图片格式文件上传后保持默认权限
- 日志正确记录ACL设置状态
- ACL设置失败时不影响文件上传流程

---

### 2. 测试功能验证
**优先级**: P0  
**预计时间**: 10分钟

验证修改后的功能：
- 上传一个PNG格式头像，检查返回的URL是否可在浏览器中直接访问
- 上传一个JPG格式头像，验证公共访问权限
- 检查日志输出是否正确记录ACL设置信息
- 确认非图片格式文件（如果系统允许）不会被设置为公共读

**依赖**: 任务1  
**可并行**: 否

**验证标准**:
- 图片URL在浏览器中可直接访问，无需任何认证
- 日志清晰展示ACL设置过程
- 原有功能（格式验证、大小限制）不受影响

---

## 任务执行顺序

1. 修改OssService.uploadAvatar方法（P0）
2. 测试功能验证（P0）

## 风险评估

**低风险**:
- 修改范围小，仅涉及单个方法
- 不改变方法签名和返回值
- ACL设置失败不影响主要上传流程
- 已有文件格式验证逻辑可复用

**无需回滚策略**: 如有问题可快速移除ACL设置代码
